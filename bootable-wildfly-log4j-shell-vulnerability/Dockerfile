FROM openjdk:11-jre-slim

RUN adduser --system --home /opt/test --shell /sbin/nologin test
    
ENV TZ=Europe/Stockholm    

RUN mkdir -p /var/test && chown test /var/test

COPY target/test-bootable.jar /opt/test/
COPY target/test.war /opt/test/

USER test

WORKDIR /var/test

EXPOSE 8080
EXPOSE 8787
EXPOSE 9990

CMD ["java", \
    "-agentlib:jdwp=transport=dt_socket,address=*:8787,server=y,suspend=n", \
     "-jar", "/opt/test/test-bootable.jar", \
     "-Djboss.bind.address=0.0.0.0", \
     "-Djboss.bind.address.management=0.0.0.0", \
     "-Djboss.server.log.dir=/var/test", \
     "--deployment=/opt/test/test.war"]

